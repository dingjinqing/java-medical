<view class="body">
    <include src="../common/header.wxml" />
    <view class="main-container">
        <!-- 可购买商品列表 -->
        <view class="list_box" wx:if="{{canBuyGoodsList.length > 0}}">
            <view class="cart-goods_item" wx:for="{{canBuyGoodsList}}" wx:key="index">
              <view class="goods_content">
                <movable-area>
                  <movable-view damping="100" x="{{item.x}}" out-of-bounds="true" direction="horizontal" bindchange="handleTouchChange" bindtouchend="handleTouchEnd" data-index="{{index}}">
                    <view class="flex_goods">
                        <view class="checkbox_box">
                            <text class="iconfont {{item.isChecked === 0 ? 'icondanxuanbiankuang':'icondanxuan'}}" style="color:{{comColor}}" bindtap="checkedToggle" data-rec_id="{{item.recId}}"></text>
                        </view>
                        <view class="goods_item">
                            <view class="goods_img">
                                <image src="{{imageUrl}}{{item.goodsImg}}" mode="widthFix"/>
                                <view class="invalid" wx:if="{{item.tip}}">
                                    {{item.tip}}
                                </view>
                            </view>
                            <view class="goods_info">
                                <view>
                                    <view class="goods_name">
                                        {{item.goodsName}}
                                    </view>
                                    <view class="goods_spec" wx:if="{{item.goodsSpecs}}">
                                        {{item.goodsSpecs}}
                                    </view>
                                </view>
                                <view class="goods_price">
                                    <view class="price" style="color:{{comColor}}">￥{{item.prdPrice}}</view>
                                    <view class="num_cfg">
                                      <view class="num_minus {{item.cartNumber <= item.limitBuyNum ? 'not_tap' : ''}}"  bindtap="{{item.cartNumber <= item.limitBuyNum ? '' : 'goodsNumChange'}}" data-rec_id="{{item.recId}}" data-type="minus">-</view>
                                      <input type="number" value="{{item.cartNumber}}"></input>
                                      <view class="num_plus {{item.cartNumber >= item.limitMaxNum ? 'not_tap' : ''}}" bindtap="{{item.cartNumber >= item.limitMaxNum ? '' : 'goodsNumChange'}}" data-rec_id="{{item.recId}}" data-type="add">+</view>
                                    </view>
                                </view>
                            </view>
                        </view>
                    </view>
                  </movable-view>
                </movable-area>
                <view class="goods_del" bindtap="delCartGoods" data-rec_id="{{item.recId}}">
                  删除
                </view>
              </view> 
            </view>
        </view>

        <!-- 失效商品列表 -->
        <view class="list_box" wx:if="{{invalidGoodsList.length > 0}}">
          <view class="invalid_title">
            <text class="title_left">失效商品 <text class="invalid_num" style="color:{{comColor}}">{{invalidGoodsList.length}}</text> 件</text>
            <text class="title_right" style="color:{{comColor}}" bindtap="clearCart">清空</text>
          </view>
          <view class="cart-goods_item" wx:for="{{invalidGoodsList}}" wx:key="index">
              <view class="goods_content">
                <view class="flex_goods">
                    <view class="goods_item">
                        <view class="goods_img">
                            <image src="{{imageUrl}}{{item.goodsImg}}" mode="widthFix"/>
                            <view class="invalid" wx:if="{{item.tip}}">
                                {{item.tip}}
                            </view>
                        </view>
                        <view class="goods_info">
                            <view>
                                <view class="goods_name">
                                    {{item.goodsName}}
                                </view>
                                <view class="goods_spec">
                                    {{item.goodsSpecs}}
                                </view>
                            </view>
                        </view>
                    </view>
                </view>
              </view> 
            </view>
        </view>

        <!-- 列表无数据时 -->

        <view class="is-null" wx:if="{{canBuyGoodsList.length === 0 && invalidGoodsList.length === 0}}">
          <image src="{{imageUrl}}image/wxapp/common_cart_no.png"></image>
          <text>购物车竟然是空的</text>
          <text class="null-btn" bindtap="toIndex" style="background-color:{{comColor}}">随便逛逛</text>
        </view>

        <!-- 底部按钮 -->
        <view class="flex_footer" wx:if="{{canBuyGoodsList.length > 0}}" style="{{!isIpx ? 'bottom:110rpx;' :'bottom:160rpx'}}">
            <view class="footer_left">
                <text class="iconfont {{allChecked ? 'icondanxuan' : 'icondanxuanbiankuang'}}" style="color:{{comColor}}" bindtap="changeAllChecked"></text>
                <text>全选</text>
            </view>
            <view class="footer_center">  
                <text>合计</text>
                 <text class="total_price" style="color:{{comColor}}">￥{{totalPrice}}</text>
            </view>
            <view class="footer_right" >
                <view class="footer_btn" bindtap="toCheckOut" style="color:#fff;background-color:{{comColor}};">
                    去结算
                </view>
            </view>
        </view>
    </view>
    <!-- <v-recommend /> -->
    <include src="../common/footer.wxml" />
</view>